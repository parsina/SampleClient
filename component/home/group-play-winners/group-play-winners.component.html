<br/>
<div style="text-align: right; width: 100%;" dir="rtl">
  <mat-select [(ngModel)]="challengeType" style="width: 20%;" (selectionChange)="changeChallengeType();" dir="rtl">
    <mat-option value="ALL">همه مسابقات</mat-option>
    <mat-option value="GOLD">مسابقات طلایی</mat-option>
    <mat-option value="SILVER">مسابقات نقره ای</mat-option>
    <mat-option value="BRONZE">مسابقات برنزی</mat-option>
  </mat-select>
</div>
<br/>
<table mat-table *ngIf="formTemplateDataSource" [dataSource]="formTemplateDataSource" matSort matSortActive="id" matSortDirection="asc" matSortDisableClear>

  <!-- Index Column -->
  <ng-container matColumnDef="index">
    <th mat-header-cell *matHeaderCellDef></th>
    <td mat-cell *matCellDef="let index = index" style="color: #ac98f2;">{{index + 1}}</td>
  </ng-container>

  <!-- Name Column -->
  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
    <td mat-cell *matCellDef="let element"> {{element.properties.name}}</td>
  </ng-container>

  <!-- Date Column -->
  <ng-container matColumnDef="numberOfForms">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>تعداد فرم</th>
    <td mat-cell *matCellDef="let element" style="color: green;">
      {{element.createdDate}}{{element.properties.numberOfForms}}
    </td>
  </ng-container>

  <!-- Value Column -->
  <ng-container matColumnDef="totalValue">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>کل مبلغ</th>
    <td mat-cell *matCellDef="let element"> {{element.properties.totalValue | currencyPipe}}
    </td>
  </ng-container>

  <tr mat-header-row class="header" *matHeaderRowDef="formTemplateColumns"></tr>
  <tr mat-row (click)="onFormTemplateClick(row)" class="formRow" [ngClass]="{'row1': index%2 == 0, 'row2': index%2 == 1, 'highlight' : selectedFormTemplateIndex == row.id}" *matRowDef="let row; columns: formTemplateColumns; let index = index"></tr>

</table>
<div style="display: flex !important;justify-content: center !important;background-color: #cee0c7;">
  <mat-paginator [showFirstLastButtons]="true" [length]="totalTemplateFormsSize" [pageSize]="10" [pageSizeOptions]="[5, 10, 50, 100]" dir="rtl" style="background-color: #cee0c7;"></mat-paginator>
</div>

<br/>
<div *ngIf="selectedFormTemplateIndex">
  <table mat-table *ngIf="winnerDataSource" [dataSource]="winnerDataSource" matSort matSortActive="id" matSortDirection="asc" matSortDisableClear>

    <!-- Index Column -->
    <ng-container matColumnDef="index">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let index = index" style="color: #ac98f2;">{{index + 1}}</td>
    </ng-container>

    <!-- selectedFormUsername Column -->
    <ng-container matColumnDef="username">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>کاربر</th>
      <td mat-cell *matCellDef="let element"> {{element.username}}</td>
    </ng-container>

    <!-- formTemplateStatus Column -->
    <ng-container matColumnDef="formName">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>فرم</th>
      <td mat-cell *matCellDef="let element" style="color: green;">{{element.farsiName}}</td>
    </ng-container>

    <!-- formTemplateValue Column -->
    <ng-container matColumnDef="formValue">
      <th mat-header-cell *matHeaderCellDef mat-sort-header style="text-align: right">مبلغ فرم(ساتوشی)</th>
      <td mat-cell *matCellDef="let element"> {{element.formValue | currencyPipe}}</td>
    </ng-container>

    <!-- formScore Column -->
    <ng-container matColumnDef="formScore">
      <th mat-header-cell *matHeaderCellDef mat-sort-header style="text-align: right">امتیاز فرم</th>
      <td mat-cell *matCellDef="let element"> {{element.formScore}}</td>
    </ng-container>

    <!-- winnerPlace Column -->
    <ng-container matColumnDef="winnerPlace">
      <th mat-header-cell *matHeaderCellDef mat-sort-header style="text-align: right">رتبه</th>
      <td mat-cell *matCellDef="let element"> {{element.winnerPlace === "First" ? 'اول' :
        element.winnerPlace === "Second" ? 'دوم' : 'سوم'}}
      </td>
    </ng-container>

    <!-- prize Column -->
    <ng-container matColumnDef="prize">
      <th mat-header-cell *matHeaderCellDef mat-sort-header style="text-align: right">مبلغ جایزه(ساتوشی)</th>
      <td mat-cell *matCellDef="let element"> {{element.prize | currencyPipe}}</td>
    </ng-container>

    <tr mat-header-row class="header" *matHeaderRowDef="winnerColumns"></tr>
    <tr mat-row (click)="onWinnerClick(row)" class="formRow" [ngClass]="{'row1': index%2 == 0, 'row2': index%2 == 1, 'highlight' : selectedFormTemplateIndex == row.id}" *matRowDef="let row; columns: winnerColumns; let index = index"></tr>

  </table>
  <div style="display: flex !important;justify-content: center !important;background-color: #cee0c7;">
    <mat-paginator *ngIf="winnersSize > 0" [showFirstLastButtons]="true" [length]="winnersSize" [pageSize]="10" [pageSizeOptions]="[5, 10, 50, 100]" dir="rtl" style="background-color: #cee0c7;"></mat-paginator>
  </div>
</div>

<br/>
<div *ngIf="selectedWinnerIndex">
  <table mat-table *ngIf="userFormDataSource" [dataSource]="userFormDataSource" class="mat-elevation-z8">

    <!-- Index Column -->
    <ng-container matColumnDef="index">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let index = index" style="color: #ac98f2;" width="5%;">{{index + 1}}</td>
    </ng-container>

    <!-- Date Column -->
    <ng-container matColumnDef="date">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element" style="color: green;" width="5%;"> {{element.properties.date}}</td>
    </ng-container>

    <!-- Time Column -->
    <ng-container matColumnDef="time">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element" style="color: green;text-align: right" width="5%;">
        {{element.properties.time}}
      </td>
    </ng-container>

    <ng-container matColumnDef="league">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element" width="10%;"> {{element.properties.league}}</td>
    </ng-container>

    <ng-container matColumnDef="homeCountry">
      <th mat-header-cell *matHeaderCellDef>کشور میهمان</th>
      <td mat-cell *matCellDef="let element" width="10%;"> {{element.properties.homeCountry}}</td>
    </ng-container>

    <ng-container matColumnDef="homeCountryFlag">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element">
        {{element.properties.liveTime}}
      </td>
    </ng-container>

    <ng-container matColumnDef="homeName">
      <th mat-header-cell *matHeaderCellDef style="text-align: left;">تیم میزبان</th>
      <td mat-cell *matCellDef="let element" style="text-align: left;" width="10%;">
        {{element.properties.homeName}}
      </td>
    </ng-container>

    <ng-container matColumnDef="homeLogo">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element" width="3%;">
        <img src="{{element.properties.homeLogo}}" title="test" alt="Smiley face" height="30" width="30">
      </td>
    </ng-container>

    <!-- homeWin CheckBox Column -->
    <ng-container matColumnDef="homeWin">
      <th mat-header-cell *matHeaderCellDef>برد میزبان</th>
      <td mat-cell *matCellDef="let element" width="5%;">
        <mat-checkbox [disabled]="true" [(ngModel)]="element.properties.homeWin"></mat-checkbox>
      </td>
    </ng-container>

    <!-- noWin CheckBox Column -->
    <ng-container matColumnDef="noWin">
      <th mat-header-cell *matHeaderCellDef>مساوی</th>
      <td mat-cell *matCellDef="let element" width="5%;">
        <mat-checkbox [disabled]="true" [(ngModel)]="element.properties.noWin"></mat-checkbox>
      </td>
    </ng-container>

    <!-- awayWin CheckBox Column -->
    <ng-container matColumnDef="awayWin">
      <th mat-header-cell *matHeaderCellDef>برد میهمان</th>
      <td mat-cell *matCellDef="let element" width="5%;">
        <mat-checkbox [disabled]="true" [(ngModel)]="element.properties.awayWin"></mat-checkbox>
      </td>
    </ng-container>

    <ng-container matColumnDef="awayLogo">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element" width="3%;">
        <img src="{{element.properties.awayLogo}}" title="test" alt="Smiley face" height="30" width="30">
      </td>
    </ng-container>

    <ng-container matColumnDef="awayName">
      <th mat-header-cell *matHeaderCellDef style="text-align: right;">تیم میهمان</th>
      <td mat-cell *matCellDef="let element" style="text-align: right; " width="10%;">
        {{element.properties.awayName}}
      </td>
    </ng-container>

    <ng-container matColumnDef="awayCountryFlag">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let element" width="10%;">
        <!--{{element.properties.awayCountryFlag}}-->
      </td>
    </ng-container>

    <ng-container matColumnDef="awayCountry">
      <th mat-header-cell *matHeaderCellDef>کشور میزبان</th>
      <td mat-cell *matCellDef="let element" width="10%;"> {{element.properties.awayCountry}}</td>
    </ng-container>

    <ng-container matColumnDef="matchScore">
      <th mat-header-cell *matHeaderCellDef>نتیحه نهایی</th>
      <td mat-cell *matCellDef="let element" width="10%;"> {{element.properties.homeScore}} -
        {{element.properties.awayScore}}
      </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef>وضعیت</th>
      <td mat-cell *matCellDef="let element" width="10%;"> {{element.properties.status}}</td>
    </ng-container>

    <ng-container matColumnDef="score">
      <th mat-header-cell *matHeaderCellDef>امتیاز</th>
      <td mat-cell *matCellDef="let element" width="10%;"> {{element.properties.score ? '1' : '0'}}</td>
    </ng-container>


    <tr mat-header-row class="header" *matHeaderRowDef="userFormColumns"></tr>
    <tr mat-row [ngClass]="{'row1': index%2 == 0, 'row2': index%2 == 1, 'winRow': (row.properties.status === 'FT' && row.properties.score == 1), 'looseRow': (row.properties.status === 'FT' && row.properties.score == 0) }" *matRowDef="let row; columns: userFormColumns; let index = index"></tr>
  </table>
  <br/>

</div>
